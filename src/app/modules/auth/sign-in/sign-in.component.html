<div
    class="flex min-h-screen min-w-0 flex-auto flex-col overflow-hidden items-center sm:flex-row sm:justify-center md:items-stretch md:justify-stretch">
    <!-- LEFT: Quick Quote Section -->
    <div
        class="relative hidden h-full max-h-screen flex-auto overflow-y-auto bg-[#04b2e1] p-16 pt-6 md:pt-8 text-white dark:border-r md:flex md:items-start md:justify-center lg:px-28">
        <!-- Decorative Rings -->
        <svg class="absolute inset-0 pointer-events-none opacity-20" viewBox="0 0 960 540" width="100%" height="100%"
            preserveAspectRatio="xMidYMax slice" xmlns="http://www.w3.org/2000/svg">
            <g fill="none" stroke="currentColor" stroke-width="100">
                <circle r="234" cx="196" cy="23"></circle>
                <circle r="234" cx="790" cy="491"></circle>
            </g>
        </svg>

        <marine-quick-quote
            *ngIf="showMarineQuote"
            (closeQuote)="onCloseMarineQuote()"
            (showLoginForQuote)="onShowLoginForQuote()"></marine-quick-quote>

        <app-quick-travel *ngIf="showTravelQuote"  (closeQuote)="onCloseTravelQuote()" (showLoginForQuote)="onShowLoginForQuote()"></app-quick-travel>

        <!-- Quick Quote Content -->
        <div class="relative z-10 w-full max-w-xl text-left flex flex-col justify-center h-full mx-auto" *ngIf="!showMarineQuote && !showTravelQuote">
            <h2 class="text-4xl font-extrabold mb-6">Get a Quick Quote</h2>
            <p class="opacity-90 mb-8 text-lg">
                Start instantly â€” no login required. Choose a product below to begin.
            </p>

            <div class="flex flex-col gap-4">
                <!-- Marine Insurance card -->
                <div class="flex flex-col items-start gap-3 rounded-2xl bg-white/10 p-4
                       sm:flex-row sm:items-center sm:justify-between sm:p-5
                       w-full max-w-[560px]">
                    <div class="flex items-start gap-3">
                        <mat-icon class="mt-0.5 text-white">directions_boat</mat-icon>

                        <div>
                            <h3 class="text-base sm:text-lg font-semibold text-white">
                                Marine Insurance
                            </h3>
                            <p class="text-xs sm:text-sm text-white/70">
                                Protect your vessels &amp; cargo
                            </p>
                        </div>
                    </div>

                    <button class="w-full rounded-xl bg-black px-3 py-1.5 sm:px-4 sm:py-2
                           text-center text-xs sm:text-sm font-medium text-white shadow-lg
                           transition-all duration-200 hover:bg-gray-800 md:w-auto" (click)="toggleMarineQuote()">
                        Get Quote
                    </button>
                </div>



                <!-- Travel Insurance card -->
                <div class="flex flex-col items-start gap-3 rounded-2xl bg-white/10 p-4
                       sm:flex-row sm:items-center sm:justify-between sm:p-5
                       w-full max-w-[560px]">
                    <div class="flex items-start gap-3">
                        <mat-icon class="mt-0.5 text-white">flight_takeoff</mat-icon>

                        <div>
                            <h3 class="text-base sm:text-lg font-semibold text-white">
                                Travel Insurance
                            </h3>
                            <p class="text-xs sm:text-sm text-white/70">
                                Protect your trips from unexpected events
                            </p>
                        </div>
                    </div>

                    <button class="w-full rounded-xl bg-black px-3 py-1.5 sm:px-4 sm:py-2
                           text-center text-xs sm:text-sm font-medium text-white shadow-lg
                           transition-all duration-200 hover:bg-gray-800 md:w-auto" (click)="toggleTravelQuote()">
                        Get Quote
                    </button>

			   </div>


			    <!-- Motor Insurance card -->
                <div class="flex flex-col items-start gap-3 rounded-2xl bg-white/10 p-4
                       sm:flex-row sm:items-center sm:justify-between sm:p-5
                       w-full max-w-[560px]">
                    <div class="flex items-start gap-3">
                        <mat-icon class="mt-0.5 text-white">directions_car</mat-icon>

                        <div>
                            <h3 class="text-base sm:text-lg font-semibold text-white">
                                Motor Insurance
                            </h3>
                            <p class="text-xs sm:text-sm text-white/70">
                                Cover your vehicles against accidents &amp; theft
                            </p>
                        </div>
                    </div>

                    <button class="w-full rounded-xl bg-black px-3 py-1.5 sm:px-4 sm:py-2
                           text-center text-xs sm:text-sm font-medium text-white shadow-lg
                           transition-all duration-200 hover:bg-gray-800 md:w-auto" (click)="toggleMotorQuote()">
                        Get Quote
                    </button>
                </div>

            </div>
        </div>
    </div>

    <!-- RIGHT: Login Form -->
    <div *ngIf="!showMarineQuote || forceShowLoginForQuote || showTravelQuote" class="w-full px-4 py-10 sm:bg-card sm:w-auto sm:rounded-2xl sm:p-12 sm:shadow
               md:flex md:h-full md:justify-end md:rounded-none md:p-16 md:shadow-none bg-white">
        <div class="mx-auto w-full max-w-80 sm:mx-0 sm:w-80">

            <!-- Logo -->
            <div class="w-full h-20 flex items-center justify-center">
                <img class="h-full w-auto" src="images/logo/logo.svg" alt="Logo" />
            </div>

            <!-- Title -->
            <div class="mt-8 text-4xl font-extrabold leading-tight tracking-tight text-[#04b2e1]">
                Sign in
            </div>

            <div class="mt-0.5 flex items-baseline font-medium">
                <div>Don't have an account?</div>
                <a class="ml-1 text-[#04b2e1] font-semibold hover:underline" [routerLink]="['/sign-up']">
                    Sign up
                </a>
            </div>

            <!-- Alert -->
            @if (showAlert) {
            <fuse-alert class="mt-8" [appearance]="'outline'" [showIcon]="false" [type]="alert.type"
                [@shake]="alert.type === 'error'">
                <span class="whitespace-pre-line">{{ alert.message }}</span>
            </fuse-alert>
            }

            <!-- Sign in form -->
            <form class="mt-8" [formGroup]="signInForm" #signInNgForm="ngForm">
                <div *ngIf="loginState === 'credentials'">
                    <!-- Email -->
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Email</mat-label>
                        <input id="username" matInput formControlName="username" />
                        <mat-error *ngIf="signInForm.get('username')?.hasError('required')">
                            Email is required
                        </mat-error>
                    </mat-form-field>

                    <!-- Password -->
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Password</mat-label>
                        <input id="password" matInput type="password" formControlName="password" #passwordField />
                        <button mat-icon-button type="button"
                            (click)="passwordField.type = passwordField.type === 'password' ? 'text' : 'password'"
                            matSuffix>
                            <mat-icon class="icon-size-5" [svgIcon]="passwordField.type === 'password'
                                    ? 'heroicons_solid:eye'
                                    : 'heroicons_solid:eye-slash'"></mat-icon>
                        </button>
                        <mat-error>Password is required</mat-error>
                    </mat-form-field>
                </div>

                <!-- OTP Section -->
                <div *ngIf="loginState === 'otp'">
                    <div class="mb-6">
                        <label class="mb-3 block text-base font-medium text-gray-900">
                            Enter OTP Code
                        </label>

                        <input type="text"
                            class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3.5 text-center text-lg font-normal tracking-[.3em] text-gray-900 focus:border-[#04b2e1] focus:ring-2 focus:ring-[#04b2e1]/20"
                            formControlName="otp" placeholder="_ _ _ _ _ _ _ _" maxlength="8"
                            [disabled]="otpCountdown <= 0 && signInForm.disabled"
                            (keydown.enter)="handleSignIn()" />

                        <div class="mt-3 flex items-center justify-between">
                            <button type="button"
                                *ngIf="otpCountdown > 0"
                                class="text-sm font-medium text-gray-500"
                                disabled>
                                Resend OTP in {{ formatCountdown(otpCountdown) }}
                            </button>

                            <button type="button"
                                *ngIf="otpCountdown <= 0"
                                (click)="resendOtp()"
                                class="inline-flex items-center justify-center rounded-full bg-[#04b2e1] px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-[#03a0c7] focus:outline-none focus:ring-2 focus:ring-[#04b2e1] focus:ring-offset-2"
                                [disabled]="signInForm.disabled">
                                Resend OTP
                            </button>

                            <button type="button"
                                (click)="backToCredentials()"
                                [disabled]="otpCountdown > 0"
                                class="inline-flex items-center justify-center rounded-full border border-gray-300 bg-white px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-[#04b2e1] focus:ring-offset-2"
                                [class.text-gray-300]="otpCountdown > 0"
                                [class.text-gray-700]="otpCountdown <= 0"
                                [class.hover:bg-gray-50]="otpCountdown <= 0">
                                Back to Login
                            </button>
                        </div>

                        <div class="mt-2 text-xs text-gray-500">
                            Didn't receive the code? Check your spam folder or request a new code after the timer expires.
                        </div>
                    </div>
                </div>

                <!-- Forgot password -->
                <div class="mt-2 inline-flex w-full items-center justify-between">
                    <a class="text-md font-medium text-[#04b2e1] hover:underline" [routerLink]="['/forgot-password']">
                        Forgot password?
                    </a>
                </div>

                <!-- Submit -->
              <button
  mat-flat-button
  color="primary"
  [disabled]="signInForm.disabled"
  (click)="handleSignIn()"
  class="w-full h-12 rounded-full bg-primary-500 text-white flex items-center justify-center
         hover:bg-secondary transition-colors fuse-mat-button-large mt-6 !min-h-0 !p-0"
>
  <span *ngIf="!signInForm.disabled">Sign in</span>

  <mat-progress-spinner
    *ngIf="signInForm.disabled"
    [diameter]="24"
    mode="indeterminate">
  </mat-progress-spinner>
</button>

            </form>
        </div>
    </div>
</div>



